# maazz-defense

`maazz-defense` یک پروژهٔ نمونه برای پیاده‌سازی «معز دیجیتال» است؛ مجموعه‌ای از ماژول‌ها و سرویس‌های کوچک که با هم کار می‌کنند تا ورود و خروج لاگ‌ها را تحلیل کرده و تهدیدهای سایبری را شناسایی کنند. این مخزن شامل کد، تنظیمات، اسکریپت‌ها و مستنداتی است که برای راه‌اندازی یک نمونهٔ اولیه (MVP) از سامانه ضروری است.

## معماری

ساختار این پروژه مبتنی‌بر معماری میکروسرویس است و هر مولفه وظیفه‌ای مشخص دارد:

| سرویس/پوشه      | توضیحات کوتاه |
|-----------------|----------------|
| **configs/**    | فایل‌های پیکربندی برای ورود داده از سرورهای لینوکس/ویندوز (Filebeat, Winlogbeat) و دیتابیس‌ها (PostgreSQL, MySQL, SQL Server, MongoDB). |
| **services/**   | شامل سرویس‌های کوچک مانند `parser`, `features`, `ml_serving`, `alerts`, `summarizer` و `reporter` که مسئول پردازش داده و تصمیم‌گیری هستند. |
| **models/**     | اسکریپت آموزش مدل ماشین یادگیری (IsolationForest) و مدل ذخیره‌شده. |
| **scripts/**    | اسکریپت‌های کمکی برای ارسال رخداد نمونه، به‌روزرسانی مدل و ... . |
| **playbooks/**  | پلی‌بوک‌های SOAR برای پاسخ به تهدیدها (مثلاً قفل حساب یا قرنطینهٔ IP). |
| **docker-compose.yml** | تعریف سرویس‌ها و وابستگی‌ها برای اجرای محلی با Docker Compose. |

## راه‌اندازی سریع

۱. **پیش‌نیازها**: نصب Docker و Docker Compose.

۲. **کلون کردن مخزن** (اگر مخزن را از گیت‌هاب دریافت می‌کنید):

```bash
git clone <REPO_URL>
cd maazz-defense
cp .env.example .env
```

۳. **آموزش مدل اولیه**:

```bash
python models/train_iforest.py
```

۴. **راه‌اندازی سرویس‌ها**:

```bash
docker compose up -d --build
```

۵. **ارسال رخداد آزمایشی** (اختیاری):

```bash
python scripts/send_sample_events.py
```

## سفارشی‌سازی

- برای تنظیم اتصال به دیتابیس‌ها، آدرس سرور Kafka یا کلید OpenAI، فایل `.env` را ویرایش کنید.
- فایل‌های درون پوشهٔ `configs/` مسیرهای لاگ و تنظیمات Beat را برای سرورهای شما مشخص می‌کنند. می‌توانید آن‌ها را بر اساس مسیرهای واقعی تغییر دهید.

## Reporter

سرویس `reporter` گزارش‌های چندرسانه‌ای تولید می‌کند. این سرویس با کمک آدرس `LLM_URL` خلاصهٔ متنی رویدادها را می‌سازد و فایل‌های خروجی را در مسیر `REPORTER_OUTPUT_DIR` ذخیره می‌کند. بر اساس پیکربندی، گزارش‌ها به کانال‌های Telegram، Slack یا Email ارسال می‌شوند و در صورت درخواست نمودار مصرف منابع نیز به صورت PNG تولید می‌گردد.

## امنیت و حریم خصوصی

این مخزن تنها یک نمونهٔ اولیه است. در محیط‌های واقعی باید موارد زیر را مد نظر داشته باشید:

- استفاده از mTLS یا VPN برای ارتباط سرویس‌ها.
- حفاظت از کلیدهای API (مثل OpenAI) با ابزارهایی مانند Vault و عدم قرار دادن آن‌ها در مخزن.
- تعریف خط‌مشی‌های دسترسی (RBAC) برای جلوگیری از دسترسی غیرمجاز.

## مجوز

این پروژه تحت مجوز MIT منتشر شده و می‌توانید آن را آزادانه استفاده و توسعه دهید، اما مسئولیت استفادهٔ امن و مطمئن بر عهدهٔ شماست.
